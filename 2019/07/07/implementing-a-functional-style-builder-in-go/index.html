<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <meta name="author" content="Preslav Rachev">
    <meta name="description" content="Go is definitely not the first language on my mind, when I hear the term “Functional Programming”. Yet, functions are first-class citizens in Go, and one can achieve a lot using higher-order functions (those that can receive and/or return other functions) alone.
In this post, I want to demonstrate the use of functional constructs for implementing the well-known Builder pattern. Please, note that there are many ways to implement a Builder, and I don&amp;rsquo;t claim that mine is certainly the best." />
    <meta name="keywords" content="programming, golang, python, elixir, Functional Programming, Golang" />
    <meta name="robots" content="noodp" />
    <meta name="theme-color" content="" />
    <link rel="canonical" href="https://preslav.me/2019/07/07/implementing-a-functional-style-builder-in-go/" />

    
    
    <title>Implementing a Functional-Style Builder in Go · Random Bits of Wisdom</title>

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    
    
    <link rel="stylesheet" href="https://preslav.me/style.main.min.3169bc690ac20e399fe6abcf32f5a891f13f367cde1295448c255e51dbd2a300.css" />
    <link rel="stylesheet" href="https://preslav.me/site.min.d1eeb730c0cb433676d79c5e0069a5b4a83a68a0851bbd9717610cbdf506b955.css" />

    

    <meta itemprop="name" content="Implementing a Functional-Style Builder in Go">
<meta itemprop="description" content="Go is definitely not the first language on my mind, when I hear the term “Functional Programming”. Yet, functions are first-class citizens in Go, and one can achieve a lot using higher-order functions (those that can receive and/or return other functions) alone.
In this post, I want to demonstrate the use of functional constructs for implementing the well-known Builder pattern. Please, note that there are many ways to implement a Builder, and I don&rsquo;t claim that mine is certainly the best.">


<meta itemprop="datePublished" content="2019-07-07T10:17:00&#43;00:00" />
<meta itemprop="dateModified" content="2019-07-07T10:17:00&#43;00:00" />
<meta itemprop="wordCount" content="735">



<meta itemprop="keywords" content="Functional Programming,Golang," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://preslav.me/images/avatar.jpg"/>

<meta name="twitter:title" content="Implementing a Functional-Style Builder in Go"/>
<meta name="twitter:description" content="Go is definitely not the first language on my mind, when I hear the term “Functional Programming”. Yet, functions are first-class citizens in Go, and one can achieve a lot using higher-order functions (those that can receive and/or return other functions) alone.
In this post, I want to demonstrate the use of functional constructs for implementing the well-known Builder pattern. Please, note that there are many ways to implement a Builder, and I don&rsquo;t claim that mine is certainly the best."/>

    
    
        
        
    
    

    
    
    

</head>
<body class=" post-template ">

    <div class="site-wrapper">

<header class="site-header"><div class="outer site-nav-main">
    <div class="inner"><nav class="site-nav">
    <div class="site-nav-left">
        
            <a class="site-nav-logo" href="https://preslav.me">Random Bits of Wisdom</a>
        
        
        <div class="site-nav-content">
            <ul class="nav" role="menu">
                
                <li class="nav-home" role="menuitem"><a href="/about/">About Me</a></li>
                
                <li class="nav-home" role="menuitem"><a href="/projects/">Projects</a></li>
                
                <li class="nav-home" role="menuitem"><a href="/privacy/">Privacy</a></li>
                
                <li class="nav-home" role="menuitem"><a href="/contact/">Contact</a></li>
                
            </ul>
        </div>
        
    </div>
</nav>

</div>
</div></header>

<main id="site-main" class="site-main outer">
    <div class="inner">

        <article class="post-full post ">

            <header class="post-full-header">

                
                    
                    <section class="post-full-tags">
                        <a href="/tags/functional-programming">Functional Programming</a>
                    </section>
                

                <h1 class="post-full-title">Implementing a Functional-Style Builder in Go</h1>

                

                <div class="post-full-byline">
                    <section class="post-full-byline-content">

                        <ul class="author-list">
    <li class="author-list-item">
        <div class="author-card">
            <div class="author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg></div>
            <div class="author-info">
                <div class="author-info">
                    <h2>Preslav Rachev</h2>
                </div>
            </div>
        </div>
        <a href="#" class="author-avatar author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg></a>
    </li>
</ul>

                        <section class="post-full-byline-meta">
                            
                                <h4 class="author-name">Preslav Rachev</h4>
                            
                            <div class="byline-meta-content">
                                <time class="byline-meta-date" datetime="2019-107-07">7 July 2019</time>
                                <span class="byline-reading-time"><span class="bull">&bull;</span> 4 min read</span>
                            </div>
                        </section>

                    </section>


                </div>
            </header>

            

            <section class="post-full-content">
                <div class="post-content">
                    

<p>Go is definitely not the first language on my mind, when I hear the term “Functional Programming”. Yet, functions are <a href="https://golangbot.com/first-class-functions/">first-class citizens</a> in Go, and one can achieve a lot using higher-order functions (those that can receive and/or return other functions) alone.</p>

<p>In this post, I want to demonstrate the use of functional constructs for implementing the well-known <a href="https://en.wikipedia.org/wiki/Builder_pattern">Builder</a> pattern. Please, note that there are many ways to implement a Builder, and I don&rsquo;t claim that mine is certainly the best. Think of it as a neat and simple exercise that would teach you some introductory functional concepts in the scope of Go.</p>

<p>To begin with, what is a <a href="https://en.wikipedia.org/wiki/Builder_pattern">Builder</a>? Builders help separate the <em>construction</em> of an object from its <em>representation</em>. Often, when dealing with complex object configurations, we end up writing code like this:</p>

<pre><code class="language-golang">instance := NewInstanceBuilder().
	WithA(1).
	WithB(2).
	WithC(3).
	Build()
</code></pre>

<p>using an intermediate Builder <code>struct</code>, or more directly:</p>

<pre><code class="language-golang">instance := NewInstance().
	WithA(1).
	WithB(2).
	WithC(3)
</code></pre>

<p>which is not safe, because the final instance is accessible at any point in time, and can be modified by any other goroutine running in parallel.</p>

<h1 id="a-functional-approach-to-building">A Functional Approach to Building</h1>

<p>Functional programming guarantees the safety of providing the instance only at the final step. At the same time, it can help minimise boilerplate. Using the functional approach, no additional structs should be necessary. Let&rsquo;s see how we can achieve this. Start with our core <code>struct</code>:</p>

<pre><code class="language-golang">type MyStruct struct {
	a int
	b int
}
</code></pre>

<p>Nothing special there. Now, pay attention to the next line of code:</p>

<pre><code class="language-golang">type Decorator func(m *MyStruct) *MyStruct
</code></pre>

<p>What do we have here? One of the revelations for every new Go programmer is that everything in Go can be a type, including functions. In our case, we specify a type called <code>Decorator</code>, to which we pass an instance of <code>MyStruct</code>, it performs some modifications on it, and returns the modified instance.</p>

<p><small><strong>Side note:</strong> the use of a pointer makes the example simpler. It is also safe-enough, since the <code>MyStruct</code> instance will not be accessible until the final build step. Still, if you prefer <a href="https://en.wikipedia.org/wiki/Pure_function">pure functions</a>, the example should be equally easy to implement using value-copying.</small></p>

<p>The really ingenious thing of thinking about a function as a type, is that we can reuse the type, and what&rsquo;s even more grounbreaking, add functionality to it. Check this out:</p>

<pre><code class="language-golang">func (f Decorator) WithA(a int) Decorator {
	return func(m *MyStruct) *MyStruct {
		f(m).a = a
		return m
	}
}
</code></pre>

<p>What did we just do? We added more functionality to <code>Decorator</code> - a higher-order function, which unwraps the decorator it has been attached to by calling it, modifies the value, and wraps it in a new <code>Decorator</code>.</p>

<p>The same way, we can add a function that sets the <code>b</code> property of our <code>MyStruct</code>:</p>

<pre><code class="language-golang">func (f Decorator) WithB(b int) Decorator {
	return func(m *MyStruct) *MyStruct {
		f(m).b = b
		return m
	}
}
</code></pre>

<p>By now you have probably started to guess that attaching decorators to each other will form a chain, which, when eventually executed, will unwrap itself in a reverse manner, each decorator applying its modifications to the passed <code>MyStruct</code> instance.</p>

<p>We are almost done, but how do we actually get our <code>MyStruct</code> instance out? We need some sort of a Go-style <code>constructor</code> function, right? Indeed, we do, but our <code>constructor</code> is a little different when we apply the <code>Builder</code> pattern. Instead of returning the <code>MyStruct</code> instance, it would rather create a simple no-op <code>Decorator</code> function, so we can attach other decorators to it:</p>

<pre><code class="language-golang">func NewMyStruct() Decorator {
	return func(m *MyStruct) *MyStruct {
		// This function really does nothing 
		return m
	}
}
</code></pre>

<p>The last part of our construct is the actual <code>Build</code> method. Its role is to create an empty <code>MyStruct</code> instance and pass it onto the decorator that it gets attached to:</p>

<pre><code class="language-golang">func (f Decorator) Build() *MyStruct {
	return f(&amp;MyStruct{})
}
</code></pre>

<p>Please, recall that since the chain of <code>Decorator</code> functions gets unwrapped in a reverse fashion, even though <code>Build</code> is the last method to be called, it is actually the one that starts the unwrapping of the chain.</p>

<p>Finally, let&rsquo;s see how we can use our <code>Builder</code>:</p>

<pre><code class="language-golang">instance := NewMyType().
		WithA(42).
		WithB(123).
		Build()

// at this point, `instance` is fully configured and ready for use
</code></pre>

<p>You can see the entire example in action <a href="https://play.golang.org/p/kmDh_oD-8qu">here</a></p>

<p>I hope you liked my little take on Go-style functional programming, applied to the Builder pattern. Feel free to share your feedback.</p>

<p>Happy coding!</p>

                </div>
            </section>

        </article>

    </div>
</main>
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
    
    <article class="read-next-card">
        <header class="read-next-card-header">
            <h3><span>More in</span> <a href="/tags/functional-programming">Functional Programming</a></h3>
        </header>
        <div class="read-next-card-content">
            <ul>
                
            </ul>
        </div>
    </article>


    
    
        
    


<article class="post-card post


 ">

        
            <a class="post-card-image-link" href="https://preslav.me/2019/06/23/sofia-s-trams/">
                <img class="post-card-image"src="https://upload.wikimedia.org/wikipedia/commons/e/ee/Tatra_T6A5_Sofia.jpg" alt="Sofia&#39;s Trams"/>
            </a>
        
    
        <div class="post-card-content">
            
    
            <a class="post-card-content-link" href="https://preslav.me/2019/06/23/sofia-s-trams/">
    
                <header class="post-card-header">
                    
                        
                        <div class="post-card-primary-tag">Trams</div>
                    

                    <h2 class="post-card-title">Sofia&#39;s Trams</h2>
                </header>
    
                <section class="post-card-excerpt">
                    <p>It has been almost a decade, since I last set foot in the city center of Bulgaria’s capital, Sofia. Although I fly home regularly, Sofia’s Airport is just an intermediary stop on my ultimate route to my hometown.
This time was different. My wife and I flew for the wedding of one of our best friends, and since we had a whole day to spare, we decided to take a walk through the centre of the City of Trams.</p>
                </section>
    
            </a>

            <footer class="post-card-meta">
                    <div class="post-card-byline-content">
                        <span class="post-card-byline-date"><time datetime="2019-96-06">23 June 2019</time>
                            <span class="bull">&bull;</span> 1 min read</span>
                    </div>
                </footer>
    
        </div>

</article>
    

            

    
    
        
    


<article class="post-card post


 ">

        
            <a class="post-card-image-link" href="https://preslav.me/2019/07/09/adding-version-information-to-go-binaries/">
                <img class="post-card-image"src="https://blog.alexellis.io/content/images/2017/08/pexels-photo-249580_crop.jpg" alt="Adding Version Information to Go Binaries"/>
            </a>
        
    
        <div class="post-card-content">
            
    
            <a class="post-card-content-link" href="https://preslav.me/2019/07/09/adding-version-information-to-go-binaries/">
    
                <header class="post-card-header">
                    
                        
                        <div class="post-card-primary-tag">Tips</div>
                    

                    <h2 class="post-card-title">Adding Version Information to Go Binaries</h2>
                </header>
    
                <section class="post-card-excerpt">
                    <p>One of the things that I find really neat about Go, is the single-executable delivery model. For small projects, it&rsquo;s as simple as dragging and dropping the built executable right where I need it. After some time, however, I might easily forget which version of my codebase a given executable has been built upon. If I have to revert a change, how can I make sure that I build from the right commit?</p>
                </section>
    
            </a>

            <footer class="post-card-meta">
                    <div class="post-card-byline-content">
                        <span class="post-card-byline-date"><time datetime="2019-47-07">9 July 2019</time>
                            <span class="bull">&bull;</span> 3 min read</span>
                    </div>
                </footer>
    
        </div>

</article>
    
        </div>
    </div>
</aside>


        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://preslav.me">Random Bits of Wisdom</a> &copy; 2019</section>
                <nav class="site-footer-nav">
                    <a href="https://preslav.me">Latest Posts</a>
                    
                    <a href="https://twitter.com/preslavrachev" target="_blank" rel="noopener">Twitter</a>
                    <a href="https://github.com/preslavrachev" target="_blank" rel="noopener">Github</a>
                    <a href="https://jonathanjanssens.com" target="_blank" rel="noopener" style="opacity: 0.5;">Hugo Casper3 by Jonathan Janssens</a>
                </nav>
            </div>
        </footer>

    </div>

    



<script type="text/javascript" src="/bundle.min.d050a0c3d6a040d6e4f2df0e396650b42a388cecdff4a0a49016fc6feeeceaa1ef57ea994d68bd39794dea102bae81bdb5a7682bfbd0d12751b0b4e0f3ace050.js" integrity="sha512-0FCgw9agQNbk8t8OOWZQtCo4jOzf9KCkkBb8b&#43;7s6qHvV&#43;qZTWi9OXlN6hArroG9tadoK/vQ0SdRsLTg86zgUA=="></script>



    <script type="text/plain" cookie-consent="tracking">
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
            ga('create', 'UA-131031623-1', 'auto');
            ga('send', 'pageview');
        </script>


<script type="text/plain" cookie-consent="targeting">
    /* Hotjar Tracking Code for https://preslav.me */
(function (h, o, t, j, a, r) {
    h.hj =
      h.hj ||
      function () {
        (h.hj.q = h.hj.q || []).push(arguments);
      };
    h._hjSettings = { hjid: 1770517, hjsv: 6 };
    a = o.getElementsByTagName("head")[0];
    r = o.createElement("script");
    r.async = 1;
    r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
    a.appendChild(r);
  })(window, document, "https://static.hotjar.com/c/hotjar-", ".js?sv=");
</script>

<script async type="text/plain" cookie-consent="functionality" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<noscript><a href="https://www.FreePrivacyPolicy.com/cookie-consent/">Cookie Consent by Free Privacy Policy Generator</a></noscript>


</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <meta name="author" content="Preslav Rachev">
    <meta name="description" content="Many thanks to @themaour for sharing this tip on Twitter TIL that in Go, struct size depends on how underlying types were defined.
struct { a bool b int32 c string d string }  The size of the struct above is is different from the one down below
struct { b int32 c string d string a bool }  Why is that? Well, think of memory as consisting of segments of certain size, where, if the amount of data you fill the segment with is bigger than the current remainder of the segment, the data will get written onto the next segment." />
    <meta name="keywords" content="programming, golang, python, elixir, Optimization, Tips, Struct, Golang" />
    <meta name="robots" content="noodp" />
    <meta name="theme-color" content="" />
    <link rel="canonical" href="https://preslav.me/2019/08/27/reduce-struct-size-by-laying-out-attributes-accordingly/" />

    
    
    <title>Reduce Struct Size by Laying out Attributes Accordingly Â· Random Bits of Wisdom</title>

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    
    
    <link rel="stylesheet" href="https://preslav.me/style.main.min.f84d6c0bd7277a0da9d1f4e0e893918c0b07491e54e74d802499c473ec868f38.css" />
    <link rel="stylesheet" href="https://preslav.me/site.min.d1eeb730c0cb433676d79c5e0069a5b4a83a68a0851bbd9717610cbdf506b955.css" />

    

    <meta itemprop="name" content="Reduce Struct Size by Laying out Attributes Accordingly">
<meta itemprop="description" content="Many thanks to @themaour for sharing this tip on Twitter TIL that in Go, struct size depends on how underlying types were defined.
struct { a bool b int32 c string d string }  The size of the struct above is is different from the one down below
struct { b int32 c string d string a bool }  Why is that? Well, think of memory as consisting of segments of certain size, where, if the amount of data you fill the segment with is bigger than the current remainder of the segment, the data will get written onto the next segment.">


<meta itemprop="datePublished" content="2019-08-27T15:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2019-08-27T15:00:00&#43;00:00" />
<meta itemprop="wordCount" content="234">



<meta itemprop="keywords" content="Optimization,Tips,Struct,Golang," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Reduce Struct Size by Laying out Attributes Accordingly"/>
<meta name="twitter:description" content="Many thanks to @themaour for sharing this tip on Twitter TIL that in Go, struct size depends on how underlying types were defined.
struct { a bool b int32 c string d string }  The size of the struct above is is different from the one down below
struct { b int32 c string d string a bool }  Why is that? Well, think of memory as consisting of segments of certain size, where, if the amount of data you fill the segment with is bigger than the current remainder of the segment, the data will get written onto the next segment."/>

    <meta property="og:title" content="Reduce Struct Size by Laying out Attributes Accordingly" />
<meta property="og:description" content="Many thanks to @themaour for sharing this tip on Twitter TIL that in Go, struct size depends on how underlying types were defined.
struct { a bool b int32 c string d string }  The size of the struct above is is different from the one down below
struct { b int32 c string d string a bool }  Why is that? Well, think of memory as consisting of segments of certain size, where, if the amount of data you fill the segment with is bigger than the current remainder of the segment, the data will get written onto the next segment." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://preslav.me/2019/08/27/reduce-struct-size-by-laying-out-attributes-accordingly/" />
<meta property="article:published_time" content="2019-08-27T15:00:00+00:00" />
<meta property="article:modified_time" content="2019-08-27T15:00:00+00:00" />

    
    
        
        
    
    
    <meta name="twitter:image" content="/images/avatar.jpg">
    <meta property="og:image" content="/images/avatar.jpg">
    

    
    
    

    <link rel="amphtml" type="text/html"
        href="https://preslav.me/amp/2019/08/27/reduce-struct-size-by-laying-out-attributes-accordingly/">
    </head>
<body class=" post-template ">

    <div class="site-wrapper">

<header class="site-header"><div class="outer site-nav-main">
    <div class="inner"><nav class="site-nav">
    <div class="site-nav-left">
        
            <a class="site-nav-logo" href="https://preslav.me">Random Bits of Wisdom</a>
        
        
        <div class="site-nav-content">
            <ul class="nav" role="menu">
                
                <li class="nav-home" role="menuitem"><a href="/about/">About Me</a></li>
                
                <li class="nav-home" role="menuitem"><a href="/projects/">Projects</a></li>
                
                <li class="nav-home" role="menuitem"><a href="/privacy/">Privacy</a></li>
                
                <li class="nav-home" role="menuitem"><a href="/contact/">Contact</a></li>
                
            </ul>
        </div>
        
    </div>
</nav>

</div>
</div></header>

<main id="site-main" class="site-main outer">
    <div class="inner">

        <article class="post-full post  no-image ">

            <header class="post-full-header">

                
                    
                    <section class="post-full-tags">
                        <a href="/tags/optimization">Optimization</a>
                    </section>
                

                <h1 class="post-full-title">Reduce Struct Size by Laying out Attributes Accordingly</h1>

                

                <div class="post-full-byline">
                    <section class="post-full-byline-content">

                        <ul class="author-list">
    <li class="author-list-item">
        <div class="author-card">
            <div class="author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg></div>
            <div class="author-info">
                <div class="author-info">
                    <h2>Preslav Rachev</h2>
                </div>
            </div>
        </div>
        <a href="#" class="author-avatar author-profile-image"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M3.513 18.998C4.749 15.504 8.082 13 12 13s7.251 2.504 8.487 5.998C18.47 21.442 15.417 23 12 23s-6.47-1.558-8.487-4.002zM12 12c2.21 0 4-2.79 4-5s-1.79-4-4-4-4 1.79-4 4 1.79 5 4 5z" fill="#FFF"/></g></svg></a>
    </li>
</ul>

                        <section class="post-full-byline-meta">
                            
                                <h4 class="author-name">Preslav Rachev</h4>
                            
                            <div class="byline-meta-content">
                                <time class="byline-meta-date" datetime="2019-38-08">27 August 2019</time>
                                <span class="byline-reading-time"><span class="bull">&bull;</span> 2 min read</span>
                            </div>
                        </section>

                    </section>


                </div>
            </header>

            

            <section class="post-full-content">
                <div class="post-content">
                    

<h5 id="many-thanks-to-themaour-https-twitter-com-themaour-status-1165555578019692544-for-sharing-this-tip-on-twitter">Many thanks to <a href="https://twitter.com/themaour/status/1165555578019692544">@themaour</a> for sharing this tip on Twitter</h5>

<p>TIL that in Go, struct size depends on how underlying types were defined.</p>

<pre><code class="language-go">struct {
	a bool
    b int32
    c string
    d string
}
</code></pre>

<p>The size of the struct above is is different from the one down below</p>

<pre><code class="language-go">struct {
	b int32
    c string
    d string
    a bool
}
</code></pre>

<p>Why is that? Well, think of memory as consisting of segments of certain size, where, if the amount of data you fill the segment with is bigger than the current remainder of the segment, the data will get written onto the next segment. The remaining space (a.k.a, <em>padding</em>) remains unused, and every instance of your struct might have some portion of unused padding when initialised.</p>

<p>There is a <a href="http://golang-sizeof.tips">great online resource</a> where you can see this by providing a sample struct definition. Let&rsquo;s see what it shows for struct #1:</p>

<p><img src="/images/2019/08/Image 2019-08-27 18-07-29.png" alt="" /></p>

<p>and struct #2:</p>

<p><img src="/images/2019/08/Image 2019-08-27 18-03-26.png" alt="" /></p>

<p>Think of this the next time you get to process a slice of 1 mln instances of a given struct.</p>

<h1 id="resources">Resources</h1>






<style scoped>
  @media (max-width: 640px) {
    .embed-image {
      min-width: 100%;
    }
  }
</style>
<div
  style="display:flex; flex-wrap: wrap; border: 1px solid #d4d4d4; width:100%; margin-bottom: 1rem">

  

  <div class="embed-image"
    style="flex: 1 1 0%; background: rgba(0, 0, 0, 0) linear-gradient(#eaeaea 0%, #73747b 100%) repeat scroll 0% 0%; min-height: 120px;">
  </div>

  

  <div class="embed-content" style="flex:3; padding: 1rem;"><a
      href="http://www.catb.org/esr/structure-packing/">
      <div class="title"
        style="font-weight: 800; margin-bottom: 1rem; font-size:120%">
        The Lost Art of Structure Packing</div>
    </a>
    <div class="embed-description" style="margin-bottom:1rem; font-size:80%">
      This page is about a technique for reducing the memory footprint of
programs in compiled languages with C-like structures - manually
repacking these declarations for reduced size. To read it, you will
require basic knowledge of the C programming language.</div>
    <div class="embed-meta" style="font-size:60%">
      <div style="float:left; max-width:80%"><a
          href="http://www.catb.org/esr/structure-packing/">http://www.catb.org | </a></div>
      <div style="float: right">Created with <a
          href="https://noembed.preslav.me/">NoEmbed</a></div>
    </div>
  </div>
</div>

                </div>
            </section>

        </article>

    </div>
</main>
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
    
    <article class="read-next-card">
        <header class="read-next-card-header">
            <h3><span>More in</span> <a href="/tags/optimization">Optimization</a></h3>
        </header>
        <div class="read-next-card-content">
            <ul>
                
            </ul>
        </div>
    </article>


    
    


<article class="post-card post
 no-image
 ">

        
    
        <div class="post-card-content">
            
    
            <a class="post-card-content-link" href="https://preslav.me/2019/08/23/mind-the-frog/">
    
                <header class="post-card-header">
                    

                    <h2 class="post-card-title">Mind the Frog</h2>
                </header>
    
                <section class="post-card-excerpt">
                    <p>If you put a frog in a frying pan, it will quickly jump out. Yet, if you put the frog in cold water and slowly heat, the frog will enjoy the warmth until it&rsquo;s too late to escape.
 We have all heard that story, but how many of us can admit that we play the frog on a daily basis? Especially at work, people tend to put a lot more focus on what they are working on and rather, avoid having a say on how the rest of the organization moves forward.</p>
                </section>
    
            </a>

            <footer class="post-card-meta">
                    <div class="post-card-byline-content">
                        <span class="post-card-byline-date"><time datetime="2019-108-08">23 August 2019</time>
                            <span class="bull">&bull;</span> 2 min read</span>
                    </div>
                </footer>
    
        </div>

</article>
    

            

    
    


<article class="post-card post
 no-image
 ">

        
    
        <div class="post-card-content">
            
    
            <a class="post-card-content-link" href="https://preslav.me/2019/08/29/goland-license/">
    
                <header class="post-card-header">
                    
                        
                        <div class="post-card-primary-tag">Golang</div>
                    

                    <h2 class="post-card-title">Bought a Year-Long License for GoLand</h2>
                </header>
    
                <section class="post-card-excerpt">
                    <p>NOTE: This is not a paid product endorsement. I&rsquo;m just a happy customer. I have recently bought a full license of GoLand for a year. The trial served me well for a few months, but the IDE shutting down automatically after every 30 minutes of work, became way too annoying. I know, I shouldn&rsquo;t rely on an IDE for writing Go, when VS Code or Vim would have worked just fine.</p>
                </section>
    
            </a>

            <footer class="post-card-meta">
                    <div class="post-card-byline-content">
                        <span class="post-card-byline-date"><time datetime="2019-108-08">29 August 2019</time>
                            <span class="bull">&bull;</span> 2 min read</span>
                    </div>
                </footer>
    
        </div>

</article>
    
        </div>
    </div>
</aside>


        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://preslav.me">Random Bits of Wisdom</a> &copy; 2019</section>
                <nav class="site-footer-nav">
                    <a href="https://preslav.me">Latest Posts</a>
                    
                    <a href="https://twitter.com/preslavrachev" target="_blank" rel="noopener">Twitter</a>
                    <a href="https://github.com/preslavrachev" target="_blank" rel="noopener">Github</a>
                    <a href="https://jonathanjanssens.com" target="_blank" rel="noopener" style="opacity: 0.5;">Hugo Casper3 by Jonathan Janssens</a>
                </nav>
            </div>
        </footer>

    </div>

    



<script type="text/javascript" src="/bundle.min.d050a0c3d6a040d6e4f2df0e396650b42a388cecdff4a0a49016fc6feeeceaa1ef57ea994d68bd39794dea102bae81bdb5a7682bfbd0d12751b0b4e0f3ace050.js" integrity="sha512-0FCgw9agQNbk8t8OOWZQtCo4jOzf9KCkkBb8b&#43;7s6qHvV&#43;qZTWi9OXlN6hArroG9tadoK/vQ0SdRsLTg86zgUA=="></script>



    <script type="text/plain" cookie-consent="tracking">
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
            ga('create', 'UA-131031623-1', 'auto');
            ga('send', 'pageview');
        </script>


<script type="text/plain" cookie-consent="targeting">
    /* Hotjar Tracking Code for https://preslav.me */
(function (h, o, t, j, a, r) {
    h.hj =
      h.hj ||
      function () {
        (h.hj.q = h.hj.q || []).push(arguments);
      };
    h._hjSettings = { hjid: 1770517, hjsv: 6 };
    a = o.getElementsByTagName("head")[0];
    r = o.createElement("script");
    r.async = 1;
    r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv;
    a.appendChild(r);
  })(window, document, "https://static.hotjar.com/c/hotjar-", ".js?sv=");
</script>

<script async type="text/plain" cookie-consent="functionality" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<noscript><a href="https://www.FreePrivacyPolicy.com/cookie-consent/">Cookie Consent by Free Privacy Policy Generator</a></noscript>


</body>

</html>